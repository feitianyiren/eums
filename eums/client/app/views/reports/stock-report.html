<div class="container-fluid" id="stock-report">
    <div class="content">
        <h4 class="page-header">Stock Report</h4>
        <ng-toast></ng-toast>

        <div>
            <div class="form-horizontal">
                <div class="header-section">
                    <div class="form-group col-lg-5 margin-top-15">
                        <div class="pad-bottom-5" style="overflow: hidden;">
                            <div class="col-lg-3 filter-label">
                                <label class="control-label description-label" for="select-district">District:</label>
                            </div>
                            <div class="col-lg-9" ng-if="districtsLoaded">
                                <input id="select-district" class="form-control" type="hidden" search-from-list
                                       list="{{ districts }}"
                                       ng-model="reportParams.selectedLocation" placeholder="All Districts">
                            </div>
                        </div>
                        <div class="pad-top-5 pad-bottom-5" style="overflow: hidden;">
                            <div class="col-lg-3 filter-label">
                                <label class="control-label description-label" for="select-ip">IP:</label>
                            </div>
                            <div class="col-lg-9">
                                <input id="select-ip" class="form-control" type="hidden" search-consignees
                                       ng-model="reportParams.selectedIPId" placeholder="All Implementing Partners">
                            </div>
                        </div>
                        <div class="pad-top-5">
                            <div class="col-lg-3 filter-label">
                                <label class="control-label description-label" for="filter-programme-container">Outcome:</label>
                            </div>
                            <div class="col-lg-9" id="filter-programme-container">
                                <input class="form-control" search-programmes-better type="text"
                                       ng-model="reportParams.selectedOutcomeId" placeholder="All Outcomes"/>
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-lg-4 pull-right text-color-dark-grey ">
                        <div class="font-size-x-large bold pad-bottom-5">
                            TOTAL
                        </div>
                        <div class="col-lg-9 bold text-uppercase total-value-box">
                            <div class="col-lg-12 pad-bottom-5 pad-top-10">
                                Value Received:
                                <span id="total_received" class="pull-right eums-font-size-large">
                                    {{ totals.total_received | currency }}
                                </span>
                            </div>
                            <div class="col-lg-12 pad-bottom-5">
                                Value Dispensed:
                                <span id="total_dispensed" class="pull-right eums-font-size-large">
                                    {{ totals.total_dispensed | currency }}
                                </span>
                            </div>
                            <div class="col-lg-12 eums-solid-bottom-border-2px"></div>
                            <div class="col-lg-12 pad-top-5 pad-bottom-5">
                                Balance:
                                <span id="total_balance" class="pull-right eums-font-size-large eums-text-color-no">
                                    {{ totals.balance | currency }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div ng-show="hasEmptyDataResponse()" class="empty-data-response">
                    There is no data for the specified filters.
                </div>

                <div>
                    <div class="panel-body">
                        <table class="table table-bordered table-striped table-hover table-condensed text-left">
                            <thead>
                            <tr>
                                <th class="col-lg-1 centered">PO Number</th>
                                <th class="col-lg-3 centered">Outcome</th>
                                <th class="col-lg-3 centered">Last Shipment Date</th>
                                <th class="col-lg-2 centered">Value Received</th>
                                <th class="col-lg-2 centered">Value Dispensed</th>
                                <th class="col-lg-1 centered">Balance</th>
                            </tr>
                            </thead>
                            <tbody ng-repeat="reportItem in reportData">
                            <tr>

                                <td class="centered">
                                    <a href
                                       ng-click="toggleOpenDocument(reportItem.document_number)">
                                        {{reportItem.document_number }}
                                    </a>
                                </td>
                                <td>{{ reportItem.programme }}</td>
                                <td class="centered">{{ reportItem.last_shipment_date | date: 'dd-MMM-yyyy' }}</td>
                                <td><span class="pull-right">{{ reportItem.total_value_received | currency }}</span></td>
                                <td><span class="pull-right">{{ reportItem.total_value_dispensed | currency }}</span></td>
                                <td><span class="pull-right">{{ reportItem.balance | currency }}</span></td>
                            </tr>
                            <tr ng-show="openDocument === reportItem.document_number">
                                <td></td>
                                <td colspan="6">
                                    <table class="nested table table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <td>Item (A)</td>
                                            <td>Description (B)</td>
                                            <td class="col-lg-1">District</td>
                                            <td class="col-lg-2">IP</td>
                                            <td>Quantity Delivered (C)</td>
                                            <td>Date Delivered (D)</td>
                                            <td>Quantity Confirmed (E)</td>
                                            <td>Date Confirmed (F)</td>
                                            <td>Quantity Dispatched (G)</td>
                                            <td>Balance (E - G)</td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr ng-repeat="item in reportItem.items">
                                            <td>{{ item.code }}</td>
                                            <td>{{ item.description }}</td>
                                            <td>{{ item.location }}</td>
                                            <td>{{ item.consignee }}</td>
                                            <td><span class="pull-right">{{ item.quantity_delivered }}</span></td>
                                            <td>{{ item.date_delivered | date: 'dd-MMM-yyyy'}}</td>
                                            <td><span class="pull-right">{{ item.quantity_confirmed }}</span></td>
                                            <td>{{ item.date_confirmed | date: 'dd-MMM-yyyy'}}</td>
                                            <td><span class="pull-right">{{ item.quantity_dispatched }}</span></td>
                                            <td><span class="pull-right">{{ item.balance }}</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                            </tbody>
                            <tfoot>
                            <tr>
                                <td colspan="10" class="centered">
                                    <pagination total-items="count"
                                                ng-model="currentPage"
                                                boundary-links="true"
                                                ng-change="goToPage(currentPage)"
                                                max-size="5"
                                                rotate="false"
                                                items-per-page="pageSize">
                                    </pagination>
                                </td>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>